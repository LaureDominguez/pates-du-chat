<section class="content shop">
    <div class="shop-filter">
        <h1>Toutes les pâtes</h1>

        <div class="filterBox">
            <button type="button" class="btn" id="filterBtn">Filtrer</button>
            <div id="filter">
                <!-- affiche la liste des catégories dispo, si elle contient des produist -->
                <?php foreach ($categories as $category) : ?>
                    <?php
                    $hasActiveProducts = false;
                    foreach ($products as $product) {
                        if ($product["cat_id"] == $category["id"] && $product['categoryActive'] && $product["active"]) {
                            $hasActiveProducts = true;
                            break;
                        }
                    }
                    ?>
                    <?php if ($hasActiveProducts) : ?>
                        <div>
                            <input type="checkbox" class="filter" data-id="<?= htmlspecialchars($category['name']); ?>" data-name="filter" checked>
                            <label for="filter"><?= htmlspecialchars($category['name']); ?></label>
                        </div>
                    <?php endif; ?>
                <?php endforeach; ?>
            </div>
        </div>
    </div>


    <?php foreach ($categories as $category) : ?>

        <!-- affiche la catégories, si elle contient des produist -->
        <?php
        $hasActiveProducts = false;
        foreach ($products as $product) {
            if ($product["cat_id"] == $category["id"] && $product['categoryActive'] && $product["active"]) {
                $hasActiveProducts = true;
                break;
            }
        }
        ?>

        <?php if ($category['active'] && $hasActiveProducts) : ?>
            <article class="shop-cat">
                <h2><?= htmlspecialchars($category["name"]); ?></h2>
                <div>
                    <?php foreach ($products as $product) : ?>
                        <?php if ($product["cat_id"] == $category["id"] && $product['categoryActive'] && $product["active"]) : ?>
                            <figure class="shop-tuile">
                                <a href="index.php?route=shopDetail&id=<?= htmlspecialchars($product['id']); ?>">
                                    <?php if (!empty($product["img"])) : ?>
                                        <img src="public/img/produits/<?= $product['image']; ?>" alt="<?= $product['imgTitle']; ?>">
                                    <?php else : ?>
                                        <img src="public/img/site/logo-Arnaud.png" alt="Image non disponible">
                                    <?php endif; ?>

                                    <figcaption>
                                        <h3 class="title-tuile"><?= htmlspecialchars($product["name"]); ?></h3>
                                        <h4><?= htmlspecialchars($product["price"]); ?>€ / kg</h4>
                                    </figcaption>
                                </a>
                            </figure>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </div>

            </article>
        <?php endif; ?>
    <?php endforeach; ?>
</section>